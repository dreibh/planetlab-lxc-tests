# $Id$
import time
import os
import commands

def header(message):
    now=time.strftime("%H:%M:%S", time.localtime())
    print "*",now,'--',message


def popen(command, fatal=True):
    (stdin, stdout, stderr) = os.popen3(command)
    output = stdout.readlines()
    
    # filter output generated by set x
    remove_set_x = lambda line: not line.startswith("+") 	 
    errors = filter(remove_set_x, stderr.readlines())
    
    if fatal and errors:
	raise Exception, "".join(errors)	
    return (output, errors)    
    
def commands(command, fatal = True):
    (status, output) = commands.getstatusoutput(command)
    if fatal and not status == 0:
	raise Exception, "%(command)s Failed:\n%(output)s" % locals()
    return (status, output)	   		 
